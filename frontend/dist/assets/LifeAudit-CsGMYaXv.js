import{j as e,m as s,D as t,h as a,y as i,g as l,f as r,T as n,F as d,C as c,q as x,o as m,R as o,z as p}from"./vendor-ui-CAagWUPt.js";import{r as u}from"./vendor-react-CtfPXauy.js";import{a as h,z as b}from"./index-IoBOCSTw.js";import{R as g,a as j,P as y,b as N,c as f,d as v,T as S}from"./vendor-charts-DGhGoZcJ.js";import"./vendor-supabase-QeT-7LZZ.js";const w=()=>{const[w,k]=u.useState(null),[A,z]=u.useState(null),[C,D]=u.useState(!0),[$,F]=u.useState(!0),[R,M]=u.useState(!1),[L,P]=u.useState("report"),[E,U]=u.useState({health:5,career:5,finance:5,relationships:5,personalGrowth:5,recreation:5,environment:5,spirituality:5}),[O,B]=u.useState(""),G=async()=>{try{F(!0);const{data:e}=await h.get("/life-audit/report");z(e)}catch(e){}finally{F(!1)}};u.useEffect(()=>{(async()=>{try{const{data:e}=await h.get("/life-audit");e&&e.length>0?(k(e[0]),U(e[0].ratings||e[0].scores||{health:5,career:5,finance:5,relationships:5,personalGrowth:5,recreation:5,environment:5,spirituality:5}),B(e[0].notes||"")):M(!0),D(!1)}catch(e){b.error("Failed to load life audit"),D(!1)}})(),G()},[]);const W=E||{health:5,career:5,finance:5,relationships:5,personalGrowth:5,recreation:5,environment:5,spirituality:5},Y=Object.keys(W).map(e=>({subject:e.charAt(0).toUpperCase()+e.slice(1).replace(/([A-Z])/g," $1"),A:W[e],fullMark:10}));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-text-main mb-1",children:"Life Audit"}),e.jsx("p",{className:"text-text-muted text-sm",children:A?`Report for ${A.month}`:"Your monthly intelligence report"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>P("report"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors "+("report"===L?"bg-primary text-white shadow-sm":"bg-gray-100 text-text-muted hover:bg-gray-200"),children:"Monthly Report"}),e.jsx("button",{onClick:()=>P("self-assess"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors "+("self-assess"===L?"bg-primary text-white shadow-sm":"bg-gray-100 text-text-muted hover:bg-gray-200"),children:"Self Assessment"})]})]}),"report"===L&&e.jsx(e.Fragment,{children:$?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):A?e.jsxs("div",{className:"space-y-6",children:[e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card p-6 bg-gradient-to-r from-indigo-600 via-blue-600 to-cyan-500 text-white shadow-xl",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold mb-1",children:[A.month," — Life Report"]}),e.jsx("p",{className:"text-white/80 text-sm",children:"Auto-generated from your subscriptions, documents, and self-assessment"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-white/70",children:"Overall Score"}),e.jsx("p",{className:"text-4xl font-black",children:A.selfAssessment.overallScore||"—"})]}),e.jsx("div",{className:"text-xs text-white/60",children:"/10"})]})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[{label:"Monthly Spend",value:`$${A.moneySummary.totalMonthlyCost}`,icon:t,color:"bg-blue-50 text-blue-600"},{label:"Potential Savings",value:`$${A.moneySummary.potentialSavings}`,icon:a,color:"bg-emerald-50 text-emerald-600"},{label:"Risks Found",value:A.risksSummary.totalRisks,icon:i,color:A.risksSummary.totalRisks>0?"bg-red-50 text-red-600":"bg-gray-50 text-gray-500"},{label:"Deadlines",value:A.deadlinesSummary.totalDeadlines,icon:l,color:A.deadlinesSummary.totalDeadlines>0?"bg-amber-50 text-amber-600":"bg-gray-50 text-gray-500"},{label:"Docs Attention",value:A.documentsAttention.totalNeedingAttention,icon:r,color:A.documentsAttention.totalNeedingAttention>0?"bg-orange-50 text-orange-600":"bg-gray-50 text-gray-500"}].map((t,a)=>e.jsxs(s.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1*a},className:"card p-4",children:[e.jsx("div",{className:`inline-flex p-2 rounded-lg mb-2 ${t.color}`,children:e.jsx(t.icon,{size:18})}),e.jsx("p",{className:"text-2xl font-bold text-text-main",children:t.value}),e.jsx("p",{className:"text-xs text-text-muted",children:t.label})]},t.label))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2.5 bg-emerald-50 text-emerald-600 rounded-xl",children:e.jsx(t,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-text-main",children:"Money Summary"}),e.jsxs("p",{className:"text-xs text-text-muted",children:[A.moneySummary.subscriptionCount," subscriptions tracked"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-xl",children:[e.jsx("span",{className:"text-sm text-text-muted",children:"Monthly subscription cost"}),e.jsxs("span",{className:"font-bold text-text-main",children:["$",A.moneySummary.totalMonthlyCost]})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-emerald-50 rounded-xl border border-emerald-100",children:[e.jsx("span",{className:"text-sm text-emerald-700",children:"Potential savings (flagged subs)"}),e.jsxs("span",{className:"font-bold text-emerald-700",children:["$",A.moneySummary.potentialSavings,"/mo"]})]}),A.moneySummary.upcomingPayments.length>0&&e.jsxs("div",{className:"pt-2",children:[e.jsx("p",{className:"text-xs font-semibold text-text-muted mb-2",children:"UPCOMING PAYMENTS"}),A.moneySummary.upcomingPayments.map(s=>e.jsxs("div",{className:"flex justify-between items-center py-1.5 text-sm",children:[e.jsx("span",{className:"text-text-main",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-text-muted",children:["$",s.price]}),e.jsxs("span",{className:"text-xs px-1.5 py-0.5 bg-blue-100 text-blue-600 rounded font-medium",children:[s.daysLeft,"d"]})]})]},s.id))]})]})]}),e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2.5 rounded-xl "+(A.risksSummary.totalRisks>0?"bg-red-50 text-red-600":"bg-gray-50 text-gray-400"),children:e.jsx(i,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-text-main",children:"Risks Detected"}),e.jsxs("p",{className:"text-xs text-text-muted",children:[A.risksSummary.totalRisks," risks from document analysis"]})]})]}),A.risksSummary.risks.length>0?e.jsx("div",{className:"space-y-2",children:A.risksSummary.risks.map((s,t)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-red-50/50 rounded-xl border border-red-100",children:[e.jsx(n,{size:14,className:"text-red-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-800",children:s.risk}),e.jsxs("p",{className:"text-[10px] text-red-500 mt-0.5",children:["From: ",s.documentName]})]})]},t))}):e.jsxs("div",{className:"text-center py-8 text-text-muted",children:[e.jsx(i,{size:32,className:"mx-auto mb-2 text-emerald-400"}),e.jsx("p",{className:"text-sm",children:"No risks detected — looking good!"})]})]}),e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2.5 rounded-xl "+(A.deadlinesSummary.totalDeadlines>0?"bg-amber-50 text-amber-600":"bg-gray-50 text-gray-400"),children:e.jsx(l,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-text-main",children:"Deadlines Coming Up"}),e.jsxs("p",{className:"text-xs text-text-muted",children:[A.deadlinesSummary.totalDeadlines," in the next 30 days"]})]})]}),A.deadlinesSummary.totalDeadlines>0?e.jsxs("div",{className:"space-y-2",children:[A.deadlinesSummary.expiredDocuments.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-xl border border-red-100",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{size:14,className:"text-red-500"}),e.jsx("span",{className:"text-sm text-red-800",children:s.name})]}),e.jsx("span",{className:"text-xs font-bold px-2 py-0.5 bg-red-100 text-red-700 rounded-full",children:"Expired"})]},s.id)),A.deadlinesSummary.expiringDocuments.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-amber-50 rounded-xl border border-amber-100",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{size:14,className:"text-amber-600"}),e.jsx("span",{className:"text-sm text-amber-800",children:s.name})]}),e.jsxs("span",{className:"text-xs font-bold px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full",children:[s.daysLeft,"d left"]})]},s.id)),A.deadlinesSummary.upcomingPayments.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-xl border border-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(c,{size:14,className:"text-blue-500"}),e.jsxs("span",{className:"text-sm text-blue-800",children:[s.name," — $",s.price]})]}),e.jsxs("span",{className:"text-xs font-bold px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full",children:[s.daysLeft,"d"]})]},s.id))]}):e.jsxs("div",{className:"text-center py-8 text-text-muted",children:[e.jsx(x,{size:32,className:"mx-auto mb-2 text-emerald-400"}),e.jsx("p",{className:"text-sm",children:"No upcoming deadlines — you're all clear!"})]})]}),e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"card p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2.5 rounded-xl "+(A.subscriptionsFlagged.highCostCount>0?"bg-orange-50 text-orange-600":"bg-gray-50 text-gray-400"),children:e.jsx(c,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-text-main",children:"Subscriptions Flagged"}),e.jsxs("p",{className:"text-xs text-text-muted",children:[A.subscriptionsFlagged.highCostCount," high-cost subscriptions"]})]})]}),A.subscriptionsFlagged.flaggedSubscriptions.length>0?e.jsxs("div",{className:"space-y-2",children:[A.subscriptionsFlagged.flaggedSubscriptions.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-xl border border-orange-100",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-orange-800",children:s.name}),e.jsxs("p",{className:"text-[10px] text-orange-600",children:[s.category," • ",s.period]})]}),e.jsxs("span",{className:"font-bold text-orange-700",children:["$",s.monthlyCost,"/mo"]})]},s.id)),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-emerald-50 rounded-xl border border-emerald-100 mt-3",children:[e.jsx("span",{className:"text-sm text-emerald-700 font-medium",children:"If cancelled, you'd save"}),e.jsxs("span",{className:"font-bold text-emerald-700",children:["$",A.subscriptionsFlagged.potentialMonthlySavings,"/mo"]})]})]}):e.jsxs("div",{className:"text-center py-8 text-text-muted",children:[e.jsx(c,{size:32,className:"mx-auto mb-2 text-emerald-400"}),e.jsx("p",{className:"text-sm",children:"No flagged subscriptions — spending looks healthy!"})]})]}),e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"card p-6 lg:col-span-2",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2.5 rounded-xl "+(A.documentsAttention.totalNeedingAttention>0?"bg-purple-50 text-purple-600":"bg-gray-50 text-gray-400"),children:e.jsx(r,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-text-main",children:"Documents Needing Attention"}),e.jsxs("p",{className:"text-xs text-text-muted",children:[A.documentsAttention.expiredCount," expired, ",A.documentsAttention.expiringCount," expiring soon"]})]})]}),A.documentsAttention.documents.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:A.documentsAttention.documents.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-xl border "+("expired"===s.status?"bg-red-50 border-red-100":"bg-amber-50 border-amber-100"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{size:14,className:"expired"===s.status?"text-red-500":"text-amber-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium "+("expired"===s.status?"text-red-800":"text-amber-800"),children:s.name}),e.jsxs("p",{className:"text-[10px] "+("expired"===s.status?"text-red-500":"text-amber-600"),children:[s.category," • Exp: ",s.expiryDate]})]})]}),e.jsx("span",{className:"text-xs font-bold px-2 py-0.5 rounded-full "+("expired"===s.status?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"),children:"expired"===s.status?"Expired":`${s.daysLeft}d left`})]},s.id))}):e.jsxs("div",{className:"text-center py-8 text-text-muted",children:[e.jsx(d,{size:32,className:"mx-auto mb-2 text-emerald-400"}),e.jsx("p",{className:"text-sm",children:"All documents are up to date!"})]})]})]})]}):e.jsxs("div",{className:"text-center py-20 text-text-muted bg-white rounded-2xl border border-dashed border-border-light",children:[e.jsx(m,{size:40,className:"mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"Unable to generate report. Add some data first!"})]})}),"self-assess"===L&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-end",children:!R&&w&&e.jsxs("button",{onClick:()=>M(!0),className:"btn btn-secondary flex items-center gap-2",children:[e.jsx(o,{size:18})," Update Audit"]})}),C?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"card p-6 flex flex-col items-center justify-center min-h-[400px]",children:[e.jsx("h3",{className:"text-lg font-bold text-text-main mb-4",children:"Your Balance Wheel"}),e.jsx("div",{className:"w-full h-[350px]",children:e.jsx(g,{width:"100%",height:"100%",children:e.jsxs(j,{cx:"50%",cy:"50%",outerRadius:"80%",data:Y,children:[e.jsx(y,{}),e.jsx(N,{dataKey:"subject",tick:{fill:"#6B7280",fontSize:12}}),e.jsx(f,{angle:30,domain:[0,10]}),e.jsx(v,{name:"Score",dataKey:"A",stroke:"#2563EB",strokeWidth:2,fill:"#3B82F6",fillOpacity:.5}),e.jsx(S,{})]})})})]}),e.jsxs(s.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"card p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-bold text-text-main",children:R?"Update Your Scores":"Current Scores"}),R&&e.jsx("span",{className:"text-xs bg-blue-50 text-blue-600 px-2 py-1 rounded-full font-medium",children:"Scale: 1 (Low) - 10 (High)"})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault();const s=b.loading("Saving audit...");try{const{data:e}=await h.post("/life-audit",{scores:E,notes:O});k(e),M(!1),b.success("Life Audit saved!",{id:s}),G()}catch(t){b.error("Failed to save",{id:s})}},className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.keys(W).map(s=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-1 capitalize",children:s.replace(/([A-Z])/g," $1")}),e.jsx("input",{type:"range",min:"1",max:"10",value:E[s],onChange:e=>((e,s)=>{U(t=>({...t,[e]:parseInt(s)}))})(s,e.target.value),disabled:!R,className:"w-full accent-primary h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer disabled:cursor-not-allowed"}),e.jsxs("div",{className:"flex justify-between text-xs text-text-muted mt-1",children:[e.jsx("span",{children:"1"}),e.jsx("span",{className:"font-bold text-primary",children:E[s]}),e.jsx("span",{children:"10"})]})]},s))}),e.jsxs("div",{className:"pt-4 border-t border-border-light",children:[e.jsx("label",{className:"block text-sm font-medium text-text-main mb-2",children:"Reflections & Notes"}),e.jsx("textarea",{className:"input w-full h-24",placeholder:"What's going well? What needs attention?",value:O,onChange:e=>B(e.target.value),disabled:!R})]}),R&&e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[w&&e.jsx("button",{type:"button",onClick:()=>{M(!1),U(w.ratings||w.scores)},className:"btn btn-ghost",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",children:[e.jsx(p,{size:18})," Save Audit"]})]})]})]})]})]})]})};export{w as default};
